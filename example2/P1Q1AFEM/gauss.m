% gauss Return Gauss weights and points 
%
%    [weights,nodes] = gauss(i)
%    Returns i Gauss weights and nodes. i must be in [1:8,2^(4:14)].

function  [weights,nodes] = gauss(i)
% [weights,nodes] = gaussAll(i);
% return

if ~ismember(i,[1:7, 2.^(3:14)])
  i0 = i;
  i = min(2^ceil(log2(i)),16384);
  disp(['Warning: Gauss rule for ',num2str(i0),...
        ' Gauss points not supported. ',...
        'Using ',num2str(i),' Gauss points.'])  
end

if ( i == 1 )
  weights = 2.0 ;
  nodes   = 0.0 ; 
elseif ( i == 2 )
  weights=[ 1.0 ; 
            1.0 ];
  nodes=[-0.577350269189626;     
          0.577350269189626]; 
elseif ( i == 3 )
  weights=[0.55555555555555556;
           0.88888888888888889;
           0.55555555555555556];
  nodes =[-0.774596669241483;
           0;
           0.774596669241483];
elseif ( i == 4 )
  weights=[   0.347854845137453;     0.652145154862546;
              0.652145154862546;     0.347854845137453];
  nodes=[  -0.861136311594053;    -0.339981043584856;
             0.339981043584856;     0.861136311594053];
 elseif ( i == 5 )
   
   weights=[   0.236926885056189E+00;     0.478628670499367E+00;
               0.568888888888889E+00;     0.478628670499366E+00;
               0.236926885056189E+00];
             
   nodes=[  -0.906179845938664E+00;    -0.538469310105683E+00;
             0.0;                       0.538469310105683E+00;
             0.906179845938664E+00];
 elseif ( i == 6 )
   
   weights=[   0.171324492379170E+00;     0.360761573048139E+00;
               0.467913934572691E+00;     0.467913934572691E+00;
               0.360761573048139E+00;     0.171324492379171E+00];
             
   nodes=[  -0.932469514203152E+00;    -0.661209386466265E+00;
            -0.238619186083197E+00;     0.238619186083197E+00;
             0.661209386466265E+00;     0.932469514203152E+00];

 elseif ( i == 7 ) 

   weights=[0.129484966168870; 0.279705391489277;
            0.381830050505119; 0.417959183673469;
            0.381830050505119; 0.279705391489277;
            0.129484966168870];

   nodes=[-0.949107912342759;-0.741531185599394;
          -0.405845151377397; 0.0;
           0.405845151377397; 0.741531185599394;
           0.949107912342759];

 elseif ( i ==     8 )
   
   weights=[   0.101228536290377;     0.222381034453375;
               0.313706645877887;     0.362683783378362;
               0.362683783378362;     0.313706645877887;
               0.222381034453375;     0.101228536290376];
             
   nodes=[  -0.960289856497536;    -0.796666477413626;
            -0.525532409916329;    -0.183434642495650;
             0.183434642495649;     0.525532409916329;
             0.796666477413627;     0.960289856497536];

 elseif ( i == 16 )

   weights=[   0.027152459411754;     0.062253523938648;
               0.095158511682493;     0.124628971255534;
               0.149595988816577;     0.169156519395003;
               0.182603415044924;     0.189450610455069;
               0.189450610455069;     0.182603415044924;
               0.169156519395003;     0.149595988816577;
               0.124628971255534;     0.095158511682492;
               0.062253523938648;     0.027152459411753];

   nodes=[  -0.989400934991650;    -0.944575023073233;
            -0.865631202387832;    -0.755404408355003;
            -0.617876244402644;    -0.458016777657227;
            -0.281603550779259;    -0.095012509837637;
             0.095012509837637;     0.281603550779259;
             0.458016777657228;     0.617876244402644;
             0.755404408355003;     0.865631202387832;
             0.944575023073232;     0.989400934991650];

 elseif ( i == 32 ) 

   weights=[0.0070186100094700;  0.0162743947309056;  
            0.0253920653092620;  0.0342738629130214;  
            0.0428358980222266;  0.0509980592623761;  
            0.0586840934785355;  0.0658222227763618;  
            0.0723457941088485;  0.0781938957870703;  
            0.0833119242269467;  0.0876520930044038;  
            0.0911738786957638;  0.0938443990808045;  
            0.0956387200792748;  0.0965400885147278;  
            0.0965400885147278;  0.0956387200792748;  
            0.0938443990808045;  0.0911738786957638;  
            0.0876520930044038;  0.0833119242269467;  
            0.0781938957870703;  0.0723457941088485;  
            0.0658222227763618;  0.0586840934785355;  
            0.0509980592623761;  0.0428358980222266;  
            0.0342738629130214;  0.0253920653092620;  
            0.0162743947309056;  0.0070186100094700];
  
   nodes=[ -0.9972638618494815; -0.9856115115452683;  
           -0.9647622555875064; -0.9349060759377396;  
           -0.8963211557660521; -0.8493676137325699;  
           -0.7944837959679424; -0.7321821187402896;  
           -0.6630442669302152; -0.5877157572407623;  
           -0.5068999089322293; -0.4213512761306353;  
           -0.3318686022821276; -0.2392873622521370;  
           -0.1444719615827964; -0.0483076656877383;  
            0.0483076656877383;  0.1444719615827964;  
            0.2392873622521370;  0.3318686022821276;  
            0.4213512761306353;  0.5068999089322293;  
            0.5877157572407623;  0.6630442669302152;  
            0.7321821187402896;  0.7944837959679424;  
            0.8493676137325699;  0.8963211557660521;  
            0.9349060759377396;  0.9647622555875064;  
            0.9856115115452683;  0.9972638618494815];

 elseif ( i == 64 ) 

   weights=[0.001783280721696;   0.004147033260563;
   	    0.006504457968978;   0.008846759826364;
   	    0.011168139460131;   0.013463047896719;
   	    0.015726030476025;   0.017951715775697;
   	    0.020134823153530;   0.022270173808383;
   	    0.024352702568711;   0.026377469715055;
   	    0.028339672614260;   0.030234657072402;
   	    0.032057928354852;   0.033805161837142;
   	    0.035472213256882;   0.037055128540240;
   	    0.038550153178616;   0.039953741132720;
   	    0.041262563242624;   0.042473515123654;
   	    0.043583724529323;   0.044590558163757;
   	    0.045491627927418;   0.046284796581314;
   	    0.046968182816210;   0.047540165714830;
   	    0.047999388596458;   0.048344762234803;
   	    0.048575467441503;   0.048690957009140;
   	    0.048690957009140;   0.048575467441503;
   	    0.048344762234803;   0.047999388596458;
   	    0.047540165714830;   0.046968182816210;
   	    0.046284796581314;   0.045491627927418;
   	    0.044590558163757;   0.043583724529323;
   	    0.042473515123654;   0.041262563242624;
   	    0.039953741132720;   0.038550153178616;
   	    0.037055128540240;   0.035472213256882;
   	    0.033805161837142;   0.032057928354852;
   	    0.030234657072402;   0.028339672614259;
   	    0.026377469715055;   0.024352702568711;
   	    0.022270173808383;   0.020134823153530;
   	    0.017951715775697;   0.015726030476024;
   	    0.013463047896719;   0.011168139460131;
   	    0.008846759826364;   0.006504457968978;
   	    0.004147033260562;   0.001783280721696];

   nodes=[ -0.999305041735772;  -0.996340116771955;
    	   -0.991013371476744;  -0.983336253884626;
    	   -0.973326827789911;  -0.961008799652054;
    	   -0.946411374858403;  -0.929569172131940;
    	   -0.910522137078503;  -0.889315445995114;
    	   -0.865999398154093;  -0.840629296252580;
    	   -0.813265315122797;  -0.783972358943341;
    	   -0.752819907260532;  -0.719881850171611;
    	   -0.685236313054233;  -0.648965471254657;
    	   -0.611155355172393;  -0.571895646202634;
    	   -0.531279464019895;  -0.489403145707053;
    	   -0.446366017253465;  -0.402270157963991;
    	   -0.357220158337667;  -0.311322871990209;
    	   -0.264687162208767;  -0.217423643740007;
    	   -0.169644420423993;  -0.121462819296120;
    	   -0.072993121787799;  -0.024350292663425;
    	    0.024350292663424;   0.072993121787800;
    	    0.121462819296120;   0.169644420423993;
    	    0.217423643740008;   0.264687162208768;
    	    0.311322871990212;   0.357220158337669;
    	    0.402270157963993;   0.446366017253464;
    	    0.489403145707053;   0.531279464019895;
    	    0.571895646202634;   0.611155355172394;
    	    0.648965471254658;   0.685236313054234;
    	    0.719881850171611;   0.752819907260532;
    	    0.783972358943342;   0.813265315122798;
    	    0.840629296252581;   0.865999398154093;
    	    0.889315445995115;   0.910522137078504;
    	    0.929569172131940;   0.946411374858404;
    	    0.961008799652053;   0.973326827789912;
    	    0.983336253884626;   0.991013371476745;
    	    0.996340116771956;   0.999305041735772];
elseif (ismember(i,[128,256,512,1024,2048]))
  try
    [weights,nodes] = gaussMed(i);
  catch
    error('Gauss rule not supported!')
  end
elseif (ismember(i,[4096,8192,16384]))
  try
    [weights,nodes] = gaussBig(i);
  catch
    error('Gauss rule not supported!')
  end
else
    error('Gauss rule not supported!')
end
